<div class="container mt-4">
    <h2 class="text-center">Prescription Form</h2>
  
    <form [formGroup]="prescriptionForm" (ngSubmit)="onSubmit()">
      <!-- Patient Email -->
      <div class="mb-3">
        <label class="form-label">Patient Email</label>
        <input type="email" class="form-control" formControlName="patientEmail" placeholder="Enter patient email">
      </div>
  
      <!-- Doctor Name -->
      <div class="mb-3">
        <label class="form-label">Doctor Name</label>
        <input type="text" class="form-control" formControlName="doctorName" placeholder="Enter doctor's name">
      </div>
  
      <!-- Diagnosis -->
      <div class="mb-3">
        <label class="form-label">Diagnosis</label>
        <input type="text" class="form-control" formControlName="diagnosis" (focusout)="getMedicineList()" placeholder="Enter diagnosis">
      </div>
  
      <!-- Medications (Dynamic) -->
      <h4>Medications</h4>
      <div formArrayName="medications">
        <div *ngFor="let med of medications.controls; let i = index" [formGroupName]="i" class="mb-3 border p-3 rounded">
          <div class="row">
            <div class="col-md-3">
              <label class="form-label">Name</label>
              <select class="form-control" formControlName="name" (change)="populateMedDetials($event,i)">
                <option [value]="medicine.name" *ngFor="let medicine of medList">{{medicine.name}}</option>
                <!-- <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option> -->
              </select>
            </div>
            <div class="col-md-2">
              <label class="form-label">Dosage</label>
              <input type="text" class="form-control" formControlName="dosage" placeholder="e.g., 500mg">
            </div>
            <div class="col-md-2">
              <label class="form-label">Quantity</label>
              <input type="number" class="form-control" formControlName="quantity">
            </div>
            <div class="col-md-4">
              <label class="form-label">Instructions</label>
              <input type="text" class="form-control" formControlName="instructions" placeholder="Dosage instructions">
            </div>
            <div class="col-md-1 d-flex align-items-end">
              <button type="button" class="btn btn-danger" (click)="removeMedication(i)" *ngIf="medications.length > 1">
                X
              </button>
            </div>
          </div>
        </div>
      </div>
      <button type="button" class="btn btn-success mt-2" (click)="addMedication()">+ Add Medication</button>
  
      <!-- Additional Fields -->
      <div class="mb-3">
        <label class="form-label">Instructions</label>
        <textarea class="form-control" formControlName="instructions" rows="2"></textarea>
      </div>
  
      <div class="row">
        <div class="col-md-6">
          <label class="form-label">Start Date</label>
          <input type="date" class="form-control" formControlName="startDate">
        </div>
        <div class="col-md-6">
          <label class="form-label">End Date</label>
          <input type="date" class="form-control" formControlName="endDate">
        </div>
      </div>
  
      <div class="mb-3">
        <label class="form-label">Pharmacy</label>
        <input type="text" class="form-control" formControlName="pharmacy">
      </div>
  
      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary w-100 mt-3">Submit Prescription</button>
    </form>
  </div>
  